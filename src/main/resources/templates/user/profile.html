<!-- update-profile.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Cập nhật hồ sơ cá nhân</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
<div class="bg-white p-8 rounded shadow-md w-full max-w-lg">
  <h2 class="text-2xl font-bold mb-6 text-center">Cập nhật hồ sơ cá nhân</h2>

  <form id="updateProfileForm" class="space-y-4">
    <div>
      <label for="userName" class="block font-medium">Họ tên</label>
      <input type="text" id="userName" name="userName" class="mt-1 p-2 w-full border rounded" required>
    </div>

    <div>
      <label for="gender" class="block font-medium">Giới tính</label>
      <select id="gender" name="gender" class="mt-1 p-2 w-full border rounded" required>
        <option value="">-- Chọn giới tính --</option>
        <option value="Male">Nam</option>
        <option value="Female">Nữ</option>
        <option value="Other">Khác</option>
      </select>
    </div>

    <div>
      <label for="dateOfBirth" class="block font-medium">Ngày sinh</label>
      <input type="date" id="dateOfBirth" name="dateOfBirth" class="mt-1 p-2 w-full border rounded" required>
    </div>

    <button type="submit" class="w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">
      Cập nhật
    </button>
  </form>

  <p id="responseMessage" class="mt-4 text-center text-green-600 font-semibold hidden"></p>
</div>

<script>
  const token = sessionStorage.getItem('token');
  if (!token) {
    window.location.href = '/login';
  }
  document.getElementById('updateProfileForm').addEventListener('submit', async function (event) {
    event.preventDefault();

    const data = {
      userName: document.getElementById('userName').value,
      gender: document.getElementById('gender').value,
      dateOfBirth: document.getElementById('dateOfBirth').value
    };

    const response = await fetch('/api/user/update-profile', {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    });

    const messageElement = document.getElementById('responseMessage');

    if (response.ok) {
      messageElement.textContent = 'Cập nhật thành công!';
      messageElement.classList.remove('hidden');
      messageElement.classList.remove('text-red-600');
      messageElement.classList.add('text-green-600');
    } else {
      messageElement.textContent = 'Cập nhật thất bại!';
      messageElement.classList.remove('hidden');
      messageElement.classList.remove('text-green-600');
      messageElement.classList.add('text-red-600');
    }
  });
</script>
</body>
</html>
